<html>
<head>
  <title>16、视图层——WXS模块</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/10.0.16299 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 12pt;
    }
  </style>
</head>
<body>
<a name="9125"/>
<h1>16、视图层——WXS模块</h1>

<div>
<span><div><span style="font-size: 32px;"><b>16、视图层——WXS模块</b></span></div><ul><li>WXS（WeiXin Script）是小程序的一套脚本语言，结合 WXML，可以构建出页面的结构</li></ul><hr/><div><br/></div><div><span style="font-size: 24px;"><b>（1）module对象</b></span></div><hr/><ul><li>WXS 代码可以编写在 wxml 文件中的 <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">&lt;wxs&gt; 标签</span>内，或以 <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">.wxs 为后缀名的文件</span>内</li><li>每一个 .wxs 文件和 &lt;wxs&gt; 标签都是一个单独的模块</li><li>每个模块都有自己独立的作用域。即在一个模块里面定义的变量与函数，默认为私有的，对其他模块不可见</li><li>每个 wxs 模块均有一个内置的 module 对象
<ul><li>exports: 通过该属性，可以对外共享本模块的私有变量与函数。</li><li>一个模块要想对外暴露其内部的私有变量与函数，只能通过 module.exports 实现</li></ul></li><li>me.wxs</li></ul><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>var foo = &quot;'hello world' from tools.wxs&quot;;</div><div>var bar = function (d) {</div><div>     return d;</div><div>}</div><div><span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">module.exports</span></b></span> = {</div><div style="margin-left:40px;">FOO: foo,</div><div style="margin-left:40px;">bar: bar,</div><div>};</div><div><span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">module.exports.msg</span></b></span> = &quot;some msg&quot;;</div></div><ul><li>me.wxml（wxml引用wxs）</li></ul><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div><span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">&lt;wxs src=&quot;me.wxs&quot; module=&quot;tools&quot; /&gt;</span></b></span></div><div>&lt;view&gt; {{<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">tools.msg</span>}} &lt;/view&gt;</div><div>&lt;view&gt; {{<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">tools.bar(tools.FOO)</span>}} &lt;/view&gt;</div></div><div><br/></div><div><span style="font-size: 24px;"><b>（2）require</b></span></div><hr/><ul><li>在.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">wxs模块中引用其他 wxs 文件模块</span>，可以使用 require 函数</li><li>只能引用 .wxs 文件模块，且<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">必须使用相对路径</span></li><li>wxs 模块均为单例，wxs 模块在第一次被引用时，会自动初始化为<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">单例对象</span>。多个页面，多个地方，多次引用，使用的都是同一个 wxs 模块对象</li><li>如果一个 wxs 模块在定义之后，一直没有被引用，则该模块不会被解析与运行</li></ul><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>// /pages/<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">tools.wxs</span><br/><br/>
var foo = &quot;'hello world' from tools.wxs&quot;;<br/>
var bar = function (d) {<br/>
  return d;<br/>
}<br/>
module.exports = {<br/>
  FOO: foo,<br/>
  bar: bar,<br/>
};</div><div>module.exports.msg = &quot;some msg&quot;;</div><div><br/></div><div><br/></div><div>// /pages/<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">logic.wxs</span><br/><br/>
var tools = <span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">require(&quot;./tools.wxs&quot;);</span></b></span><br/><br/>
console.log(tools.FOO);<br/>
console.log(tools.bar(&quot;logic.wxs&quot;));</div><div>console.log(tools.msg);</div><div><br/></div><div><br/></div><div>&lt;!-- /page/index/<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">index.wxml</span> --&gt;<br/><br/></div><div><span style="color: rgb(255, 0, 0);"><b><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">&lt;wxs src=&quot;./../logic.wxs&quot; module=&quot;logic&quot; /&gt;</span></b></span></div><div><br/></div><div>//控制台输出</div><div>'hello world' from tools.wxs<br/>
logic.wxs<br/>
some msg</div></div><div><br/></div><div><span style="font-size: 24px;"><b>（3）&lt;wxs&gt;标签</b></span></div><hr/><ul><li>属性</li></ul><table><thead><tr><th>属性名</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tr><td>module</td><td>String</td><td><br/></td><td>当前 <code>&lt;wxs&gt;</code> 标签的模块名。必填字段。</td></tr><tr><td>src</td><td>String</td><td><br/></td><td><div>引用 .wxs 文件的相对路径。<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">仅当本标签为<strong>单闭合标签</strong>或<strong>标签的内容为空</strong>时有效</span>。</div></td></tr></table><ul><li>wxs写在wxml中的wxs标签中</li></ul><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;!--wxml--&gt;<br/><br/>
&lt;wxs <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">module=&quot;foo&quot;</span>&gt;</div><div style="margin-left:40px;">var some_msg = &quot;hello world&quot;;</div><div style="margin-left:40px;">module.exports = {</div><div style="margin-left:40px;">    msg : some_msg,</div><div style="margin-left:40px;">}</div><div>&lt;/wxs&gt;</div><div><br/></div><div>&lt;view&gt; {{foo.msg}} &lt;/view&gt;</div></div><ul><li>module属性
<ul><li>module 属性是当前 &lt;wxs&gt; 标签的模块名。在单个 wxml 文件内，建议其值唯一</li><li>有重复模块名则按照先后顺序覆盖（后者覆盖前者）</li><li>不同文件之间的 wxs 模块名不会相互覆盖。</li><li>module 属性值的命名必须符合下面两个规则：
<ul><li>首字符必须是：字母（a-zA-Z），下划线（_）</li><li>剩余字符可以是：字母（a-zA-Z），下划线（_）， 数字（0-9）</li></ul></li></ul></li><li>src属性
<ul><li>src 属性可以用来引用其他的 wxs 文件模块</li><li>只能引用 .wxs 文件模块，且必须使用相对路径</li><li>wxs 模块均为单例，wxs 模块在第一次被引用时，会自动初始化为单例对象。多个页面，多个地方，多次引用，使用的都是同一个 wxs 模块对象</li><li>如果一个 wxs 模块在定义之后，一直没有被引用，则该模块不会被解析与运行</li></ul></li><li>注意事项
<ul><li>&lt;wxs&gt; 模块只能在定义模块的 WXML 文件中被访问到。<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">使用 &lt;include&gt; 或 &lt;import&gt; 时，&lt;wxs&gt; 模块不会被引入到对应的 WXML 文件中</span>。</li><li>-&lt;template&gt; 标签中，只能使用定义该 &lt;template&gt; 的 WXML 文件中定义的 &lt;wxs&gt; 模块。</li></ul></li></ul><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 